<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ComparatorGen3_RK: ComparatorGen3_RK</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ComparatorGen3_RK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ComparatorGen3_RK </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><em>Support for the nRF52 hardware comparator for Particle user firmware</em></p>
<p>The nRF52840 MCU in Particle Gen 3 devices (Argon, Boron, B Series SoM, Tracker SoM, Tracker One) has a single analog comparator in the MCU that can be used on any of the available analog input pins. It can detect crossings, rising, falling, or both, optionally with hysteresis.</p>
<p>Note: The nRF52840 supports both COMP (comparator) and LPCOMP (low-power comparator), but only one can be used at a time.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Feature </th><th class="markdownTableHeadCenter">COMP </th><th class="markdownTableHeadCenter">LPCOMP  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Differential analog input </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter">&#160;  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Single-Ended analog input </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">External reference voltage </td><td class="markdownTableBodyCenter">AIN0 or AIN1 </td><td class="markdownTableBodyCenter">AIN0 - AIN7  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Internal reference voltage </td><td class="markdownTableBodyCenter">1.2V, 1.8V, or 2.4V </td><td class="markdownTableBodyCenter">15 steps of VDD (0.22V each)  </td></tr>
</table>
<p>The peripherals are similar but the features of the LPCOMP are what I needed and this library only supports LPCOMP. It wouldn't be hard to modify it to use COMP, but it does not currently work with COMP.</p>
<p>This library uses the nRF52 SDK to access the hardware. The SDK is available to user applications with no additional libraries, however there are some steps that need to be done when using interrupts from user firmware. The following Nordic resources will be helpful:</p>
<ul>
<li><a href="https://infocenter.nordicsemi.com/topic/ps_nrf52840/lpcomp.html?cp=4_0_0_5_11">nRF52840 LPCOMP hardware documentation</a></li>
<li><a href="https://infocenter.nordicsemi.com/topic/com.nordic.infocenter.sdk5.v15.3.0/group__nrfx__lpcomp.html">nRF52 SDK LPCOMP driver</a> containing the nRF52 SDK API</li>
<li><a href="https://infocenter.nordicsemi.com/topic/com.nordic.infocenter.sdk5.v15.3.0/group__nrf__lpcomp__hal.html">nRF52 SDK LPCOMP HAL</a> containing the constants and structures you will need</li>
</ul>
<h1>Usage</h1>
<p>See the examples for more information.</p>
<ul>
<li>1-simple - toggles the blue D7 LED on change</li>
<li>2-rising - counts the number of rising crossings and prints the results every second</li>
</ul>
<p>Even though the comparator is fast, interrupt latency makes it impossible to measure really high frequency signals. It sorts of works up to around 100,000 interrupts per second, but it loses some interrupts at the upper end of that, so it won't be particularly reliable at that rate.</p>
<p>If you use an external reference voltage, it must be on A0. It can't be on other pins. If using the internal reference, the possible values are:</p>
<ul>
<li><code>REF_0V4</code> (approximately 0.4V)</li>
<li><code>REF_0V8</code></li>
<li><code>REF_1V2</code></li>
<li><code>REF_1V7</code></li>
<li><code>REF_2V1</code></li>
<li><code>REF_2V5</code></li>
<li><code>REF_2V9</code> (approximately 2.9V)</li>
<li><code>PIN_A0</code></li>
</ul>
<p>See the <a class="el" href="_comparator_gen3___r_k_8h_source.html">ComparatorGen3_RK.h</a> file. There are numerous comments that explain the functions and values.</p>
<h1>Version History</h1>
<h2>0.0.1 (2021-10-20)</h2>
<ul>
<li>Initial version </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
